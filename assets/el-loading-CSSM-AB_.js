import{r as I,I as P,aE as O,d as j,a4 as z,ad as m,w as R,i as F,b as q,v as D,T as G,n as B,X as T,aa as S,ao as H,aF as K}from"./index-VS2PECJp.js";import{t as M}from"./use-global-config-Dz9Vncbw.js";import{V as C,a8 as X,y as b,T as k}from"./base-C1eoIJKg.js";function Y(e,n){let t;const l=I(!1),s=P({...e,originalPosition:"",originalOverflow:"",visible:!1});function r(o){s.text=o}function c(){const o=s.parent,u=v.ns;if(!o.vLoadingAddClassList){let i=o.getAttribute("loading-number");i=Number.parseInt(i)-1,i?o.setAttribute("loading-number",i.toString()):(C(o,u.bm("parent","relative")),o.removeAttribute("loading-number")),C(o,u.bm("parent","hidden"))}d(),g.unmount()}function d(){var o,u;(u=(o=v.$el)==null?void 0:o.parentNode)==null||u.removeChild(v.$el)}function _(){var o;e.beforeClose&&!e.beforeClose()||(l.value=!0,clearTimeout(t),t=setTimeout(a,400),s.visible=!1,(o=e.closed)==null||o.call(e))}function a(){if(!l.value)return;const o=s.parent;l.value=!1,o.vLoadingAddClassList=void 0,c()}const x=j({name:"ElLoading",setup(o,{expose:u}){const{ns:i,zIndex:N}=M("loading");return u({ns:i,zIndex:N}),()=>{const L=s.spinner||s.svg,V=m("svg",{class:"circular",viewBox:s.svgViewBox?s.svgViewBox:"0 0 50 50",...L?{innerHTML:L}:{}},[m("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),E=s.text?m("p",{class:i.b("text")},[s.text]):void 0;return m(G,{name:i.b("fade"),onAfterLeave:a},{default:R(()=>[F(q("div",{style:{backgroundColor:s.background||""},class:[i.b("mask"),s.customClass,s.fullscreen?"is-fullscreen":""]},[m("div",{class:i.b("spinner")},[V,E])]),[[D,s.visible]])])})}}}),g=O(x);Object.assign(g._context,n??{});const v=g.mount(document.createElement("div"));return{...z(s),setText:r,removeElLoadingChild:d,close:_,handleAfterLeave:a,vm:v,get $el(){return v.$el}}}let y;const A=function(e={},n){if(!X)return;const t=Z(e);if(t.fullscreen&&y)return y;const l=Y({...t,closed:()=>{var r;(r=t.closed)==null||r.call(t),t.fullscreen&&(y=void 0)}},n??A._context);J(t,t.parent,l),w(t,t.parent,l),t.parent.vLoadingAddClassList=()=>w(t,t.parent,l);let s=t.parent.getAttribute("loading-number");return s?s=`${Number.parseInt(s)+1}`:s="1",t.parent.setAttribute("loading-number",s),t.parent.appendChild(l.$el),B(()=>l.visible.value=t.visible),t.fullscreen&&(y=l),l},Z=e=>{var n,t,l,s;let r;return T(e.target)?r=(n=document.querySelector(e.target))!=null?n:document.body:r=e.target||document.body,{parent:r===document.body||e.body?document.body:r,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:r===document.body&&((t=e.fullscreen)!=null?t:!0),lock:(l=e.lock)!=null?l:!1,customClass:e.customClass||"",visible:(s=e.visible)!=null?s:!0,beforeClose:e.beforeClose,closed:e.closed,target:r}},J=async(e,n,t)=>{const{nextZIndex:l}=t.vm.zIndex||t.vm._.exposed.zIndex,s={};if(e.fullscreen)t.originalPosition.value=b(document.body,"position"),t.originalOverflow.value=b(document.body,"overflow"),s.zIndex=l();else if(e.parent===document.body){t.originalPosition.value=b(document.body,"position"),await B();for(const r of["top","left"]){const c=r==="top"?"scrollTop":"scrollLeft";s[r]=`${e.target.getBoundingClientRect()[r]+document.body[c]+document.documentElement[c]-Number.parseInt(b(document.body,`margin-${r}`),10)}px`}for(const r of["height","width"])s[r]=`${e.target.getBoundingClientRect()[r]}px`}else t.originalPosition.value=b(n,"position");for(const[r,c]of Object.entries(s))t.$el.style[r]=c},w=(e,n,t)=>{const l=t.vm.ns||t.vm._.exposed.ns;["absolute","fixed","sticky"].includes(t.originalPosition.value)?C(n,l.bm("parent","relative")):k(n,l.bm("parent","relative")),e.fullscreen&&e.lock?k(n,l.bm("parent","hidden")):C(n,l.bm("parent","hidden"))};A._context=null;const p=Symbol("ElLoading"),f=e=>`element-loading-${K(e)}`,h=(e,n)=>{var t,l,s,r;const c=n.instance,d=o=>S(n.value)?n.value[o]:void 0,_=o=>{const u=T(o)&&c?.[o]||o;return I(u)},a=o=>_(d(o)||e.getAttribute(f(o))),x=(t=d("fullscreen"))!=null?t:n.modifiers.fullscreen,g={text:a("text"),svg:a("svg"),svgViewBox:a("svgViewBox"),spinner:a("spinner"),background:a("background"),customClass:a("customClass"),fullscreen:x,target:(l=d("target"))!=null?l:x?void 0:e,body:(s=d("body"))!=null?s:n.modifiers.body,lock:(r=d("lock"))!=null?r:n.modifiers.lock},v=A(g);v._context=$._context,e[p]={options:g,instance:v}},Q=(e,n)=>{for(const t of Object.keys(e))H(e[t])&&(e[t].value=n[t])},$={mounted(e,n){n.value&&h(e,n)},updated(e,n){const t=e[p];if(!n.value){t?.instance.close(),e[p]=null;return}t?Q(t.options,S(n.value)?n.value:{text:e.getAttribute(f("text")),svg:e.getAttribute(f("svg")),svgViewBox:e.getAttribute(f("svgViewBox")),spinner:e.getAttribute(f("spinner")),background:e.getAttribute(f("background")),customClass:e.getAttribute(f("customClass"))}):h(e,n)},unmounted(e){var n;(n=e[p])==null||n.instance.close(),e[p]=null}};$._context=null;export{$ as v};
